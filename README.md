# qmx-birdie-scanner

**qmx-birdie-scanner** is an experimental Python project designed to detect *birdies* in **QMX** and **QMX+** transmitters manufactured by [QRP Labs](https://qrp-labs.com/). The project consists of two scripts: one for capturing audio FFT data and another for analyzing it to identify narrowband energy peaks.

## Installation

### Windows

1. **Install Python 3:**
   - Download Python 3 from [python.org](https://www.python.org/downloads/windows/)
   - During installation, make sure to check "Add Python to PATH"
   - Verify installation by opening Command Prompt and running: `python --version`

2. **Download the application code:**
   - **Option A (Git):** Clone the repository:
     ```cmd
     git clone https://github.com/gvelo/qmx-birdie-scanner.git
     cd qmx-birdie-scanner
     ```
   - **Option B (ZIP):** Download and extract the ZIP file from: https://github.com/gvelo/qmx-birdie-scanner/archive/refs/heads/main.zip

3. **Create a virtual environment:**
   ```cmd
   python -m venv venv
   ```

4. **Activate the virtual environment:**
   ```cmd
   venv\Scripts\activate
   ```

5. **Install dependencies:**
   ```cmd
   pip install -r requirements.txt
   ```

### Linux (Ubuntu)

1. **Install Python 3:**
   ```bash
   sudo apt update
   sudo apt install python3 python3-pip python3-venv git
   ```

2. **Download the application code:**
   - **Option A (Git):** Clone the repository:
     ```bash
     git clone https://github.com/gvelo/qmx-birdie-scanner.git
     cd qmx-birdie-scanner
     ```
   - **Option B (ZIP):** Download and extract the ZIP file:
     ```bash
     wget https://github.com/gvelo/qmx-birdie-scanner/archive/refs/heads/main.zip
     unzip main.zip
     cd qmx-birdie-scanner-main
     ```

3. **Create a virtual environment:**
   ```bash
   python3 -m venv venv
   ```

4. **Activate the virtual environment:**
   ```bash
   source venv/bin/activate
   ```

5. **Install dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

### macOS

1. **Install Python 3:**
   - **Option A (Homebrew - recommended):**
     ```bash
     # Install Homebrew if not already installed
     /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
     # Install Python 3
     brew install python3 git
     ```
   - **Option B (Direct download):** Download Python 3 from [python.org](https://www.python.org/downloads/macos/)

2. **Download the application code:**
   - **Option A (Git):** Clone the repository:
     ```bash
     git clone https://github.com/gvelo/qmx-birdie-scanner.git
     cd qmx-birdie-scanner
     ```
   - **Option B (ZIP):** Download and extract the ZIP file:
     ```bash
     curl -L https://github.com/gvelo/qmx-birdie-scanner/archive/refs/heads/main.zip -o main.zip
     unzip main.zip
     cd qmx-birdie-scanner-main
     ```

3. **Create a virtual environment:**
   ```bash
   python3 -m venv venv
   ```

4. **Activate the virtual environment:**
   ```bash
   source venv/bin/activate
   ```

5. **Install dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

## Scripts

### `fft_collector.py`

This script performs a frequency scan over the transmitter, controlled via CAT over a serial port. For each frequency step, it records the audio output and computes an FFT, storing the results in an HDF5 (`.h5`) file for later analysis.

#### Usage:

```bash
usage: fft_collector.py [-h] [--serial-port SERIAL_PORT] start_freq end_freq output_file

QMX FFT Frequency Scanner

positional arguments:
  start_freq              Start frequency in Hz
  end_freq                End frequency in Hz
  output_file             Output H5 filename

options:
  -h, --help              Show this help message and exit
  --serial-port SERIAL_PORT
                          Serial port for CAT control (default: /dev/ttyACM0)
```

#### Example â€“ Scan the 20-meter band:

```bash
python3 fft_collector.py --serial-port /dev/ttyACM0 14000000 14350000 scan_20m.h5
```

This will scan from **14.000 MHz to 14.350 MHz** and store the FFT results in `scan_20m.h5`.

---

### `birdie_detector.py`

This script analyzes the `.h5` file generated by `fft_collector.py`. It scans each FFT to detect *birdies* by identifying narrowband energy peaks that exceed the noise floor. It supports different plotting modes for analysis and debugging.

#### Usage:

```bash
usage: birdie_detector.py [-h] [--output-dir OUTPUT_DIR] [--plot-mode {none,birdie,all}] h5_file

QMX Birdie Detection Analysis

positional arguments:
  h5_file                 Input H5 file with FFT data to analyze

options:
  -h, --help              Show this help message and exit
  --output-dir OUTPUT_DIR
                          Output directory for FFT plots (default: current directory)
  --plot-mode {none,birdie,all}
                          Plot generation mode: none=no plots, birdie=only frequencies with birdies, 
                          all=all frequencies (WARNING: creates many files)
```

#### Examples:

**Basic analysis (no plots):**
```bash
python3 birdie_detector.py scan_20m.h5
```

**Generate plots only for frequencies with detected birdies:**
```bash
python3 birdie_detector.py --output-dir plots --plot-mode birdie scan_20m.h5
```

**Generate plots for all frequencies (debugging):**
```bash
python3 birdie_detector.py --output-dir plots --plot-mode all scan_20m.h5
```

---

## Requirements

* Python 3.7+
* Python packages: `numpy`, `matplotlib`, `h5py`, `scipy`, `sounddevice`, `argparse`

## Status

This is an experimental project 

## License

MIT

